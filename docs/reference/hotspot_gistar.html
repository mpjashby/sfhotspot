<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Identify hotspot and coldspot locations, that is cells in a regular grid in
which there are more/fewer points than would be expected if the points were
distributed randomly."><title>Identify significant spatial clusters of points — hotspot_gistar • sfhotspot</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify significant spatial clusters of points — hotspot_gistar"><meta property="og:description" content="Identify hotspot and coldspot locations, that is cells in a regular grid in
which there are more/fewer points than would be expected if the points were
distributed randomly."><meta property="og:image" content="http://pkgs.lesscrime.info/sfhotspot/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sfhotspot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mpjashby/sfhotspot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify significant spatial clusters of points</h1>
      <small class="dont-index">Source: <a href="https://github.com/mpjashby/sfhotspot/blob/HEAD/R/hotspot_gistar.R" class="external-link"><code>R/hotspot_gistar.R</code></a></small>
      <div class="d-none name"><code>hotspot_gistar.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identify hotspot and coldspot locations, that is cells in a regular grid in
which there are more/fewer points than would be expected if the points were
distributed randomly.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">hotspot_gistar</span><span class="op">(</span>
  <span class="va">data</span>,
  cell_size <span class="op">=</span> <span class="cn">NULL</span>,
  grid_type <span class="op">=</span> <span class="st">"rect"</span>,
  kde <span class="op">=</span> <span class="cn">TRUE</span>,
  bandwidth <span class="op">=</span> <span class="cn">NULL</span>,
  bandwidth_adjust <span class="op">=</span> <span class="fl">1</span>,
  grid <span class="op">=</span> <span class="cn">NULL</span>,
  weights <span class="op">=</span> <span class="cn">NULL</span>,
  nb_dist <span class="op">=</span> <span class="cn">NULL</span>,
  include_self <span class="op">=</span> <span class="cn">TRUE</span>,
  p_adjust_method <span class="op">=</span> <span class="cn">NULL</span>,
  quiet <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p><code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> data frame containing points.</p></dd>


<dt>cell_size</dt>
<dd><p><code>numeric</code> value specifying the size of each equally
spaced grid cell, using the same units (metres, degrees, etc.) as used in
the <code>sf</code> data frame given in the <code>data</code> argument. Ignored if
<code>grid</code> is not <code>NULL</code>. If this argument and <code>grid</code> are
<code>NULL</code> (the default), the cell size will be calculated automatically
(see Details).</p></dd>


<dt>grid_type</dt>
<dd><p><code>character</code> specifying whether the grid should be made
up of squares (<code>"rect"</code>, the default) or hexagons (<code>"hex"</code>).
Ignored if <code>grid</code> is not <code>NULL</code>.</p></dd>


<dt>kde</dt>
<dd><p><code>TRUE</code> (the default) or <code>FALSE</code> indicating whether
kernel density estimates (KDE) should be produced for each grid cell.</p></dd>


<dt>bandwidth</dt>
<dd><p><code>numeric</code> value specifying the bandwidth to be used in
calculating the kernel density estimates. If this argument is <code>NULL</code>
(the default), the bandwidth will be specified automatically using the mean
result of <code><a href="https://rdrr.io/pkg/MASS/man/bandwidth.nrd.html" class="external-link">bandwidth.nrd</a></code> called on the <code>x</code> and
<code>y</code> co-ordinates separately.</p></dd>


<dt>bandwidth_adjust</dt>
<dd><p>single positive <code>numeric</code> value by which the
value of <code>bandwidth</code> is multiplied. Useful for setting the bandwidth
relative to the default.</p></dd>


<dt>grid</dt>
<dd><p><code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> data frame containing polygons, which will
be used as the grid for which counts are made.</p></dd>


<dt>weights</dt>
<dd><p><code>NULL</code> or the name of a column in <code>data</code> to be used
as weights for weighted counts and KDE values.</p></dd>


<dt>nb_dist</dt>
<dd><p>The distance around a cell that contains the neighbours of
that cell, which are used in calculating the statistic. If this argument is
<code>NULL</code> (the default), <code>nb_dist</code> is set as <code>cell_size *
  sqrt(2)</code> so that only the cells immediately adjacent to each cell are
treated as being its neighbours.</p></dd>


<dt>include_self</dt>
<dd><p>Should points in a given cell be counted as well as
counts in neighbouring cells when calculating the values of
<i>G</i><sub><i>i</i></sub><sup>*</sup>
(if <code>include_self = TRUE</code>, the default) or
<i>G</i><sub><i>i</i></sub><sup>*</sup>
(if <code>include_self = FALSE</code>) values? You are unlikely to want to change
the default value.</p></dd>


<dt>p_adjust_method</dt>
<dd><p>The method to be used to adjust <em>p</em>-values for
multiple comparisons. <code>NULL</code> (the default) uses the default method
used by <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>, but any of the character values in
<code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">stats::p.adjust.methods</a></code> may be specified.</p></dd>


<dt>quiet</dt>
<dd><p>if set to <code>TRUE</code>, messages reporting the values of any
parameters set automatically will be suppressed. The default is
<code>FALSE</code>.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to <code><a href="https://rdrr.io/pkg/SpatialKDE/man/kde.html" class="external-link">kde</a></code> or
ignored if <code>kde = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An <code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> tibble of regular grid cells with
corresponding point counts,
<i>G</i><sub><i>i</i></sub><sup>*</sup> or
<i>G</i><sub><i>i</i></sub><sup>*</sup></p>


<p>values and (optionally) kernel density estimates for each cell. Values
greater than zero indicate more points than would be expected for randomly
distributed points and values less than zero indicate fewer points.
Critical values of
<i>G</i><sub><i>i</i></sub><sup>*</sup> and
<i>G</i><sub><i>i</i></sub><sup>*</sup></p>


<p>are given in the manual page for <code><a href="https://r-spatial.github.io/spdep/reference/localG.html" class="external-link">localG</a></code>.</p>


<p>The output from this function can be plotted in the same way as for other
SF objects, for which see <code><a href="https://r-spatial.github.io/sf/articles/sf5.html" class="external-link">vignette("sf5", package = "sf")</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function calculates the Getis-Ord
<i>G</i><sub><i>i</i></sub><sup>*</sup>
(gi-star) or
<i>G</i><sub><i>i</i></sub><sup>*</sup>
\(Z\)-score statistic for identifying clusters of point locations. The
underlying implementation uses the <code><a href="https://r-spatial.github.io/spdep/reference/localG.html" class="external-link">localG</a></code> function to
calculate the \(Z\) scores and then <code><a href="https://r-spatial.github.io/spdep/reference/p.adjustSP.html" class="external-link">p.adjustSP</a></code>
function to adjust the corresponding \(p\)-values for multiple comparison.
The function also returns counts of points in each cell and (by default but
optionally) kernel density estimates using the <code><a href="https://rdrr.io/pkg/SpatialKDE/man/kde.html" class="external-link">kde</a></code>
function.</p><div class="section">
<h3 id="coverage-of-the-output-data">Coverage of the output data<a class="anchor" aria-label="anchor" href="#coverage-of-the-output-data"></a></h3>


<p>The grid produced by this function covers the convex hull of the input data
layer. This means the result may include
<i>G</i><sub><i>i</i></sub><sup>*</sup> or
<i>G</i><sub><i>i</i></sub><sup>*</sup>
values for cells that are outside the area for which data were provided,
which could be misleading. To handle this, consider cropping the output layer
to the area for which data are available. For example, if you only have crime
data for a particular district, crop the output dataset to the district
boundary using <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></code>.</p>
</div>

<div class="section">
<h3 id="automatic-cell-size-selection">Automatic cell-size selection<a class="anchor" aria-label="anchor" href="#automatic-cell-size-selection"></a></h3>


<p>If no cell size is given then the cell size will be set so that there are 50
cells on the shorter side of the grid. If the <code>data</code> SF object is projected
in metres or feet, the number of cells will be adjusted upwards so that the
cell size is a multiple of 100.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Getis, A. &amp; Ord, J. K. (1992). The Analysis of Spatial Association by Use of
Distance Statistics. <em>Geographical Analysis</em>, 24(3), 189-206.
doi:doi: <a href="https://doi.org/10.1111/j.1538-4632.1992.tb00261.x" class="external-link">10.1111/j.1538-4632.1992.tb00261.x</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Transform data to UTM zone 15N so that cell_size and bandwidth can be set</span></span>
<span class="r-in"><span class="co"># in metres</span></span>
<span class="r-in"><span class="va">memphis_robberies_utm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">memphis_robberies_jan</span>, <span class="fl">32615</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Automatically set grid-cell size, bandwidth and neighbour distance</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu">hotspot_gistar</span><span class="op">(</span><span class="va">memphis_robberies_utm</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cell size set to 500 metres automatically</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bandwidth set to 8,877 metres automatically based on rule of thumb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 2715 features and 4 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 761986.2 ymin: 3876436 xmax: 794486.2 ymax: 3905936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: WGS 84 / UTM zone 15N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,715 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        n   kde gistar pvalue                                            geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                       <span style="color: #949494; font-style: italic;">&lt;POLYGON [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     0 11.1  -<span style="color: #BB0000;">0.546</span>  0.585 ((770486.2 3876436, 770986.2 3876436, 770986.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     0 11.2  -<span style="color: #BB0000;">0.598</span>  0.550 ((770986.2 3876436, 771486.2 3876436, 771486.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     0 11.2  -<span style="color: #BB0000;">0.598</span>  0.550 ((771486.2 3876436, 771986.2 3876436, 771986.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     0 11.1   0.716  0.474 ((771986.2 3876436, 772486.2 3876436, 772486.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     1 10.9   0.716  0.474 ((772486.2 3876436, 772986.2 3876436, 772986.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     0 10.5   0.716  0.474 ((772986.2 3876436, 773486.2 3876436, 773486.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     0 10.0  -<span style="color: #BB0000;">0.598</span>  0.550 ((773486.2 3876436, 773986.2 3876436, 773986.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     0  9.45 -<span style="color: #BB0000;">0.598</span>  0.550 ((773986.2 3876436, 774486.2 3876436, 774486.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     0  8.76 -<span style="color: #BB0000;">0.546</span>  0.585 ((774486.2 3876436, 774986.2 3876436, 774986.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     0 10.1   0.893  0.372 ((768486.2 3876936, 768986.2 3876936, 768986.2 387…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 2,705 more rows</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Manually set grid-cell size in metres, since the `memphis_robberies`</span></span>
<span class="r-in"><span class="co"># dataset uses a co-ordinate reference system (UTM zone 15 north) that is</span></span>
<span class="r-in"><span class="co"># specified in metres</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu">hotspot_gistar</span><span class="op">(</span><span class="va">memphis_robberies_utm</span>, cell_size <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Bandwidth set to 8,877 metres automatically based on rule of thumb</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 16133 features and 4 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 762136.2 ymin: 3876586 xmax: 794136.2 ymax: 3905386</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: WGS 84 / UTM zone 15N</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 16,133 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        n   kde gistar  pvalue                                           geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                      <span style="color: #949494; font-style: italic;">&lt;POLYGON [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     0  11.2 -<span style="color: #BB0000;">0.243</span> 0.808   ((771936.2 3876586, 772136.2 3876586, 772136.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     0  11.1 -<span style="color: #BB0000;">0.266</span> 0.790   ((772136.2 3876586, 772336.2 3876586, 772336.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     0  11.1 -<span style="color: #BB0000;">0.266</span> 0.790   ((772336.2 3876586, 772536.2 3876586, 772536.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     0  11.0  3.20  0.001<span style="text-decoration: underline;">35</span> ((772536.2 3876586, 772736.2 3876586, 772736.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     1  10.8  3.20  0.001<span style="text-decoration: underline;">35</span> ((772736.2 3876586, 772936.2 3876586, 772936.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     0  10.7  3.20  0.001<span style="text-decoration: underline;">35</span> ((772936.2 3876586, 773136.2 3876586, 773136.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     0  10.5 -<span style="color: #BB0000;">0.266</span> 0.790   ((773136.2 3876586, 773336.2 3876586, 773336.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     0  10.3 -<span style="color: #BB0000;">0.266</span> 0.790   ((773336.2 3876586, 773536.2 3876586, 773536.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     0  10.1 -<span style="color: #BB0000;">0.243</span> 0.808   ((773536.2 3876586, 773736.2 3876586, 773736.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     0  11.6 -<span style="color: #BB0000;">0.243</span> 0.808   ((771136.2 3876786, 771336.2 3876786, 771336.2 38…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 16,123 more rows</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Automatically set grid-cell size and bandwidth for lon/lat data, since it</span></span>
<span class="r-in"><span class="co"># is not intuitive to set these values manually in decimal degrees. To do</span></span>
<span class="r-in"><span class="co"># this it is necessary to not calculate KDEs due to a limitation in the</span></span>
<span class="r-in"><span class="co"># underlying function.</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu">hotspot_gistar</span><span class="op">(</span><span class="va">memphis_robberies</span>, kde <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The co-ordinates in `data` are latitudes and longitudes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> `cell_size` and `bandwidth` will be in decimal degrees</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">ℹ</span> Consider transforming `data` to use a projected CRS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cell size set to 0.00524 degrees automatically</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 2926 features and 3 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -90.1261 ymin: 34.99475 xmax: -89.72786 ymax: 35.26199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,926 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        n gistar pvalue                                                  geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                             <span style="color: #949494; font-style: italic;">&lt;POLYGON [°]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>     0 -<span style="color: #BB0000;">0.887</span>  0.375 ((-90.08418 34.99475, -90.07894 34.99475, -90.07894 34.9…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>     0 -<span style="color: #BB0000;">0.733</span>  0.463 ((-90.07894 34.99475, -90.0737 34.99475, -90.0737 34.999…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>     0 -<span style="color: #BB0000;">0.733</span>  0.463 ((-90.0737 34.99475, -90.06846 34.99475, -90.06846 34.99…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>     0 -<span style="color: #BB0000;">0.887</span>  0.375 ((-90.06846 34.99475, -90.06322 34.99475, -90.06322 34.9…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>     0 -<span style="color: #BB0000;">0.887</span>  0.375 ((-90.06322 34.99475, -90.05798 34.99475, -90.05798 34.9…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>     0 -<span style="color: #BB0000;">0.475</span>  0.635 ((-90.05798 34.99475, -90.05274 34.99475, -90.05274 34.9…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>     0 -<span style="color: #BB0000;">0.614</span>  0.539 ((-90.05274 34.99475, -90.0475 34.99475, -90.0475 34.999…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>     0 -<span style="color: #BB0000;">0.733</span>  0.463 ((-90.0475 34.99475, -90.04226 34.99475, -90.04226 34.99…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>     0 -<span style="color: #BB0000;">0.992</span>  0.321 ((-90.04226 34.99475, -90.03702 34.99475, -90.03702 34.9…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>     0 -<span style="color: #BB0000;">0.992</span>  0.321 ((-90.03702 34.99475, -90.03178 34.99475, -90.03178 34.9…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># … with 2,916 more rows</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matt Ashby.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer></div>

  

  

  </body></html>

