<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify change in hotspots over time — hotspot_change • sfhotspot</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify change in hotspots over time — hotspot_change"><meta name="description" content="Identify change in the number of points (typically representing events)
between two periods (before and after a specified date) or in two groups
(e.g. on weekdays or at weekends)."><meta property="og:description" content="Identify change in the number of points (typically representing events)
between two periods (before and after a specified date) or in two groups
(e.g. on weekdays or at weekends)."><meta property="og:image" content="http://pkgs.lesscrime.info/sfhotspot/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sfhotspot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to sfhotspot</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mpjashby/sfhotspot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Identify change in hotspots over time</h1>
      <small class="dont-index">Source: <a href="https://github.com/mpjashby/sfhotspot/blob/HEAD/R/hotspot_change.R" class="external-link"><code>R/hotspot_change.R</code></a></small>
      <div class="d-none name"><code>hotspot_change.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identify change in the number of points (typically representing events)
between two periods (before and after a specified date) or in two groups
(e.g. on weekdays or at weekends).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hotspot_change</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boundary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  groups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grid_type <span class="op">=</span> <span class="st">"rect"</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> data frame containing points.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>Name of the column in <code>data</code> containing <code>Date</code> or
<code>POSIXt</code> values representing the date associated with each point.
Ignored if <code>groups</code> is not <code>NULL</code>. If this argument is
<code>NULL</code> and <code>data</code> contains a single column of <code>Date</code> or
<code>POSIXt</code> values, that column will be used automatically.</p></dd>


<dt id="arg-boundary">boundary<a class="anchor" aria-label="anchor" href="#arg-boundary"></a></dt>
<dd><p>A single <code>Date</code> or <code>POSIXt</code> value representing the
point after which points should be treated as having occurred in the second
time period. See 'Details'.</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>Name of a column in <code>data</code> containing exactly two unique
non-missing values, which will be used to identify whether each row should
be counted in the first (before) or second (after) groups. Which groups to
use will be determined by calling <code>sort(unique(groups))</code>. If
<code>groups</code> is not a factor, a message will be printed confirming which
value has been used for which group. See 'Details'.</p></dd>


<dt id="arg-cell-size">cell_size<a class="anchor" aria-label="anchor" href="#arg-cell-size"></a></dt>
<dd><p><code>numeric</code> value specifying the size of each equally
spaced grid cell, using the same units (metres, degrees, etc.) as used in
the <code>sf</code> data frame given in the <code>data</code> argument. Ignored if
<code>grid</code> is not <code>NULL</code>. If this argument and <code>grid</code> are
<code>NULL</code> (the default), the cell size will be calculated automatically
(see Details).</p></dd>


<dt id="arg-grid-type">grid_type<a class="anchor" aria-label="anchor" href="#arg-grid-type"></a></dt>
<dd><p><code>character</code> specifying whether the grid should be made
up of squares (<code>"rect"</code>, the default) or hexagons (<code>"hex"</code>).
Ignored if <code>grid</code> is not <code>NULL</code>.</p></dd>


<dt id="arg-grid">grid<a class="anchor" aria-label="anchor" href="#arg-grid"></a></dt>
<dd><p><code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> data frame containing points containing
polygons, which will be used as the grid for which counts are made.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>if set to <code>TRUE</code>, messages reporting the values of any
parameters set automatically will be suppressed. The default is
<code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> tibble of regular grid cells with
corresponding hot-spot classifications for each cell. This can be plotted
using <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates a regular two-dimensional grid of cells (unless a
custom grid is specified with <code>grid</code>) and calculates the difference
between the number of points in each grid cell:</p><ul><li><p>before and after a set point in time, if <code>boundary</code> is specified,</p></li>
<li><p>between two groups of points, if a column of grouping values is specified
with <code>groups</code>,</p></li>
<li><p>before and after the mid-point of the dates/times present in the data, if
both <code>boundary</code> and <code>groups</code> are <code>NULL</code> (the default).</p></li>
</ul><p>If both <code>boundary</code> and <code>groups</code> are not <code>NULL</code>, the value of
<code>boundary</code> will be ignored.</p><div class="section">
<h3 id="coverage-of-the-output-data">Coverage of the output data<a class="anchor" aria-label="anchor" href="#coverage-of-the-output-data"></a></h3>


<p>The grid produced by this function covers the convex hull of the input data
layer. This means the result may include zero counts for cells that are
outside the area for which data were provided, which could be misleading. To
handle this, consider cropping the output layer to the area for which data
are available. For example, if you only have crime data for a particular
district, crop the output dataset to the district boundary using
<code><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></code>.</p>
</div>

<div class="section">
<h3 id="automatic-cell-size-selection">Automatic cell-size selection<a class="anchor" aria-label="anchor" href="#automatic-cell-size-selection"></a></h3>


<p>If no cell size is given then the cell size will be set so that there are 50
cells on the shorter side of the grid. If the <code>data</code> SF object is
projected in metres or feet, the number of cells will be adjusted upwards so
that the cell size is a multiple of 100.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="hotspot_dual_kde.html">hotspot_dual_kde()</a></code> for comparing the density of two layers, which
will often be more useful than comparing counts if the point locations
represent and underlying continuous distribution.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare counts from the first half of the period covered by the data to</span></span></span>
<span class="r-in"><span><span class="co"># counts from the second half</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu">hotspot_change</span><span class="op">(</span><span class="va">memphis_robberies</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Boundary point set as 11:30 hours on 02 July 2019 automatically</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cell size set to 0.00524 degrees automatically</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 2926 features and 3 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -90.1261 ymin: 34.99475 xmax: -89.72786 ymax: 35.26199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,926 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    n_before n_after change                                              geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                         <span style="color: #949494; font-style: italic;">&lt;POLYGON [°]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>        0       0      0 ((-90.08418 34.99475, -90.07894 34.99475, -90.07894 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>        0       0      0 ((-90.07894 34.99475, -90.0737 34.99475, -90.0737 34…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>        0       0      0 ((-90.0737 34.99475, -90.06846 34.99475, -90.06846 3…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>        0       0      0 ((-90.06846 34.99475, -90.06322 34.99475, -90.06322 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>        0       0      0 ((-90.06322 34.99475, -90.05798 34.99475, -90.05798 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>        0       0      0 ((-90.05798 34.99475, -90.05274 34.99475, -90.05274 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>        0       0      0 ((-90.05274 34.99475, -90.0475 34.99475, -90.0475 34…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>        0       0      0 ((-90.0475 34.99475, -90.04226 34.99475, -90.04226 3…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>        0       0      0 ((-90.04226 34.99475, -90.03702 34.99475, -90.03702 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>        0       0      0 ((-90.03702 34.99475, -90.03178 34.99475, -90.03178 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,916 more rows</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a grouping variable, then compare counts across values of that</span></span></span>
<span class="r-in"><span><span class="co"># variable</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">memphis_robberies</span><span class="op">$</span><span class="va">weekend</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html" class="external-link">weekdays</a></span><span class="op">(</span><span class="va">memphis_robberies</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Saturday"</span>, <span class="st">"Sunday"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">hotspot_change</span><span class="op">(</span><span class="va">memphis_robberies</span>, groups <span class="op">=</span> <span class="va">weekend</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Comparing periods based on values of `weekend`:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Rows with `weekend == FALSE` used as 'before' period</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">•</span> Rows with `weekend == TRUE` used as 'after' period</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Cell size set to 0.00524 degrees automatically</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 2926 features and 3 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: POLYGON</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: -90.1261 ymin: 34.99475 xmax: -89.72786 ymax: 35.26199</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geodetic CRS:  WGS 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,926 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    n_before n_after change                                              geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  <span style="color: #BCBCBC;">*</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                                         <span style="color: #949494; font-style: italic;">&lt;POLYGON [°]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>        0       0      0 ((-90.08418 34.99475, -90.07894 34.99475, -90.07894 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>        0       0      0 ((-90.07894 34.99475, -90.0737 34.99475, -90.0737 34…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>        0       0      0 ((-90.0737 34.99475, -90.06846 34.99475, -90.06846 3…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>        0       0      0 ((-90.06846 34.99475, -90.06322 34.99475, -90.06322 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>        0       0      0 ((-90.06322 34.99475, -90.05798 34.99475, -90.05798 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>        0       0      0 ((-90.05798 34.99475, -90.05274 34.99475, -90.05274 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>        0       0      0 ((-90.05274 34.99475, -90.0475 34.99475, -90.0475 34…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>        0       0      0 ((-90.0475 34.99475, -90.04226 34.99475, -90.04226 3…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>        0       0      0 ((-90.04226 34.99475, -90.03702 34.99475, -90.03702 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>        0       0      0 ((-90.03702 34.99475, -90.03178 34.99475, -90.03178 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,916 more rows</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Ashby.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

